{"version":3,"file":"header-102e5108.js","sources":["../../blocks/header/header.js"],"sourcesContent":["import { readBlockConfig, decorateIcons } from '../../scripts/lib-franklin.js';\nimport { isMobile } from '../../scripts/scripts.js';\n\n/**\n * collapses all open nav sections\n * @param {Element} sections The container element\n */\nfunction collapseAllNavSections(sections) {\n  sections.querySelectorAll('.nav-menu > ul > li').forEach((section) => {\n    section.setAttribute('aria-expanded', 'false');\n  });\n}\n\nfunction onScroll() {\n  const header = document.querySelector('.header');\n  if (header) {\n    if (document.documentElement.scrollTop >= 50) {\n      header.classList.add('sticky');\n    } else {\n      header.classList.remove('sticky');\n    }\n  }\n}\n\n/**\n * decorates the header, mainly the nav\n * @param {Element} block The header block element\n */\n\nexport default async function decorate(block) {\n  const cfg = readBlockConfig(block);\n  block.textContent = '';\n\n  // fetch nav content\n  let navPath = cfg.nav || '/nav';\n\n  // Load from storybook directory if running on github.io\n  if (window.location.host.includes('github.io') || !window.__STORYBOOKAPI__) {\n    navPath = 'https://main--rosalind-boilerplate--dylandepass.hlx.page/storybook/nav';\n  }\n\n  const resp = await fetch(`${navPath}.plain.html`);\n  if (resp.ok) {\n    const html = await resp.text();\n\n    // decorate nav DOM\n    const nav = document.createElement('nav');\n    nav.innerHTML = html;\n\n    const classes = ['brand', 'menu', 'tools'];\n    classes.forEach((e, j) => {\n      const section = nav.children[j];\n      if (section) section.classList.add(`nav-${e}`);\n    });\n\n    const brand = nav.querySelector('.nav-brand p');\n    const logo = document.createElement('span');\n    logo.classList.add('logo');\n    brand?.prepend(logo);\n    logo.style.setProperty('background-image', `url(${getComputedStyle(document.documentElement)\n      .getPropertyValue('--ros-semantic-assets-logo')}`);\n\n    const navMenu = [...nav.children][1];\n    if (navMenu) {\n      navMenu.querySelectorAll(':scope > ul > li').forEach((navSection) => {\n        navSection.classList.add('top-level');\n        navSection.addEventListener('mouseover', () => {\n          const expanded = navSection.getAttribute('aria-expanded') === 'true';\n          collapseAllNavSections(navMenu);\n          navSection.setAttribute('aria-expanded', expanded ? 'false' : 'true');\n        });\n\n        navSection.addEventListener('click', (event) => {\n          const parent = event.target.parentElement;\n          const hasChildren = parent.querySelector('ul') !== null;\n          if (isMobile()) {\n            // If we clicked on a top level element don't navigate and expand instead\n            if (hasChildren && parent.classList.contains('top-level')) {\n              event.preventDefault();\n            }\n          }\n\n          if (hasChildren) {\n            const child = navSection.querySelector(':scope > ul');\n            child?.classList.toggle('open');\n          }\n        });\n      });\n    }\n\n    // hamburger for mobile\n    const hamburger = document.createElement('div');\n    hamburger.classList.add('nav-hamburger');\n    hamburger.innerHTML = /* html */`\n          <div>\n            <span class=\"line\"></span>\n            <span class=\"line\"></span>\n            <span class=\"line\"></span>\n          </div>\n    `;\n    hamburger.addEventListener('click', () => {\n      hamburger.classList.toggle('active');\n      const expanded = nav.getAttribute('aria-expanded') === 'true';\n      document.body.style.overflowY = expanded ? '' : 'hidden';\n      nav.setAttribute('aria-expanded', expanded ? 'false' : 'true');\n    });\n    nav.prepend(hamburger);\n    nav.setAttribute('aria-expanded', 'false');\n    block.append(nav);\n\n    const themesBuffer = await fetch('../../themes.txt');\n    const themes = await themesBuffer.json();\n\n    const toolsContainer = document.createElement('div');\n    toolsContainer.classList.add('nav-tools');\n\n    const themeSelectContainer = document.createElement('div');\n    themeSelectContainer.classList.add('select');\n    themeSelectContainer.classList.add('theme-switcher');\n\n    const themeSelect = document.createElement('select');\n\n    const defaultOption = document.createElement('option');\n    defaultOption.value = '0';\n    defaultOption.innerText = 'Select a Theme';\n    themeSelect.append(defaultOption);\n\n    themes.forEach((theme) => {\n      const option = document.createElement('option');\n      option.value = theme.name;\n      option.innerText = theme.name;\n      themeSelect.append(option);\n    });\n\n    themeSelectContainer.append(themeSelect);\n\n    toolsContainer.append(themeSelectContainer);\n\n    nav.appendChild(toolsContainer);\n\n    themeSelect.addEventListener('change', (event) => {\n      const theme = document.getElementById('theme');\n      if (theme && event.target && event.target.value !== '0') {\n        const selection = event.target.value;\n        theme.setAttribute('href', `/styles/themes/${selection}.css`);\n        localStorage.setItem('theme', selection);\n        const el = document.querySelector('.logo');\n        el.style.display = 'none';\n        setTimeout(() => {\n          if (el) {\n            el.style.setProperty('background-image', `url(${getComputedStyle(document.documentElement).getPropertyValue('--ros-semantic-assets-logo')}`);\n            el.style.display = 'block';\n          }\n        }, 300);\n      }\n    });\n\n    decorateIcons(nav);\n\n    window.addEventListener('scroll', (ev) => {\n      ev.preventDefault();\n      onScroll();\n    });\n  }\n}\n"],"names":["collapseAllNavSections","sections","section","onScroll","header","decorate","block","cfg","readBlockConfig","navPath","resp","html","nav","j","brand","logo","navMenu","navSection","expanded","event","parent","hasChildren","isMobile","hamburger","themes","toolsContainer","themeSelectContainer","themeSelect","defaultOption","theme","option","selection","el","decorateIcons","ev"],"mappings":"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"}