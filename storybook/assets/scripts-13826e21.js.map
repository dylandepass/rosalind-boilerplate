{"version":3,"file":"scripts-13826e21.js","sources":["../../scripts/scripts.js"],"sourcesContent":["import {\n  sampleRUM,\n  buildBlock,\n  loadHeader,\n  loadFooter,\n  decorateSections,\n  decorateBlocks,\n  decorateTemplateAndTheme,\n  decorateIcons,\n  waitForLCP,\n  loadBlocks,\n  loadCSS,\n  getMetadata,\n} from './lib-franklin.js';\n\nconst LCP_BLOCKS = ['hero']; // add your LCP blocks to the list\nwindow.hlx.RUM_GENERATION = 'project-1'; // add your RUM generation information here\n\nfunction build2ColHero(main) {\n  const firstDiv = main.querySelector(':scope > div:first-of-type');\n  const picture = firstDiv.querySelector('picture');\n  const section = document.createElement('div');\n  const heroBlock = buildBlock('hero', [[{ elems: [...firstDiv.children] }, picture]]);\n  heroBlock.classList.add('hero-2-cols');\n  section.append(heroBlock);\n  firstDiv.remove();\n  main.prepend(section);\n}\n\nfunction buildImageHero(main) {\n  const firstDiv = main.querySelector('div:first-of-type');\n  const img = firstDiv.querySelector('img');\n\n  const backgroundImage = document.createElement('div');\n  backgroundImage.style.backgroundImage = `url('${img.src})`;\n  backgroundImage.classList.add('image');\n  img.closest('p').remove();\n\n  const cover = document.createElement('div');\n  cover.classList.add('cover');\n\n  const content = document.createElement('div');\n  content.classList.add('content');\n  content.append(...firstDiv.childNodes);\n\n  const section = document.createElement('div');\n  const heroBlock = buildBlock('hero', [[{ elems: [cover, backgroundImage] }, content]]);\n  heroBlock.classList.add('hero-image');\n  section.append(heroBlock);\n  firstDiv.remove();\n  main.prepend(section);\n}\n\n/**\n * Loads JS and CSS for a template.\n */\nexport async function loadTemplate(main, template) {\n  if (template) {\n    try {\n      const cssLoaded = new Promise((resolve) => {\n        loadCSS(`${window.hlx.codeBasePath}/templates/${template}/${template}.css`, resolve);\n      });\n      const decorationComplete = new Promise((resolve) => {\n        (async () => {\n          try {\n            const mod = await import(`../templates/${template}/${template}.js`);\n            if (mod.default) {\n              await mod.default(main);\n            }\n          } catch (error) {\n            // eslint-disable-next-line no-console\n            console.log(`failed to load module for ${template}`, error);\n          }\n          resolve();\n        })();\n      });\n      await Promise.all([cssLoaded, decorationComplete]);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.log(`failed to load block ${template}`, error);\n    }\n  }\n}\n\nfunction decorateTemplate(main) {\n  const template = getMetadata('template');\n  if (template && template !== 'blog' && template !== 'home') {\n    loadTemplate(main, template);\n  }\n}\n\n/**\n * Builds all synthetic blocks in a container element.\n * @param {Element} main The container element\n */\nfunction buildAutoBlocks(main) {\n  try {\n    // noop\n    const template = getMetadata('template');\n    if (!template) {\n      return;\n    }\n\n    if (template === 'home') {\n      build2ColHero(main);\n    } else if (template === 'blog') {\n      buildImageHero(main);\n    }\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('Auto Blocking failed', error);\n  }\n}\n\n/**\n * decorates paragraphs containing a single link as buttons.\n * @param {Element} element container element\n */\n\nexport function decorateButtons(element) {\n  element.querySelectorAll('a').forEach((a) => {\n    a.title = a.title || a.textContent;\n    if (a.href !== a.textContent) {\n      const up = a.parentElement;\n      const twoup = a.parentElement.parentElement;\n      if (!a.querySelector('img')) {\n        if (up.childNodes.length === 1 && (up.tagName === 'P' || up.tagName === 'DIV')) {\n          a.className = 'button primary'; // default\n          up.classList.add('button-container');\n        }\n        if (up.childNodes.length === 1 && up.tagName === 'STRONG'\n          && twoup.childNodes.length === 1 && twoup.tagName === 'P') {\n          a.className = 'button primary';\n          twoup.classList.add('button-container');\n        }\n        if (up.childNodes.length === 1 && up.tagName === 'EM'\n          && twoup.childNodes.length === 1 && twoup.tagName === 'P') {\n          a.className = 'button secondary';\n          twoup.classList.add('button-container');\n        }\n\n        if (a.textContent === '') {\n          a.classList.add('icon-only');\n        }\n      }\n    }\n  });\n}\n\n/**\n * Decorates the main element.\n * @param {Element} main The main element\n */\n// eslint-disable-next-line import/prefer-default-export\nexport function decorateMain(main) {\n  // hopefully forward compatible button decoration\n  decorateButtons(main);\n  buildAutoBlocks(main);\n  decorateSections(main);\n  decorateBlocks(main);\n}\n\nexport function loadTheme() {\n  const themeLink = document.getElementById('theme');\n  const theme = localStorage.getItem('theme');\n  if (theme && themeLink) {\n    themeLink.setAttribute('href', `${window.hlx.codeBasePath}/styles/themes/${theme}.css`);\n  }\n}\n\nexport function isMobile() {\n  return window.innerWidth < 900;\n}\n\n/**\n * loads everything needed to get to LCP.\n */\nasync function loadEager(doc) {\n  document.documentElement.lang = 'en';\n  decorateTemplateAndTheme();\n  loadTheme();\n  const main = doc.querySelector('main');\n  decorateTemplate(main);\n  if (main) {\n    decorateMain(main);\n    await waitForLCP(LCP_BLOCKS);\n  }\n}\n\n/**\n * Adds the favicon.\n * @param {string} href The favicon URL\n */\nexport function addFavIcon(href) {\n  const link = document.createElement('link');\n  link.rel = 'icon';\n  link.type = 'image/svg+xml';\n  link.href = href;\n  const existingLink = document.querySelector('head link[rel=\"icon\"]');\n  if (existingLink) {\n    existingLink.parentElement.replaceChild(link, existingLink);\n  } else {\n    document.getElementsByTagName('head')[0].appendChild(link);\n  }\n}\n\n/**\n * loads everything that doesn't need to be delayed.\n */\nasync function loadLazy(doc) {\n  const main = doc.querySelector('main');\n  await loadBlocks(main);\n\n  decorateIcons(main);\n  const { hash } = window.location;\n  const element = hash ? main.querySelector(hash) : false;\n  if (hash && element) element.scrollIntoView();\n\n  if (!window.__STORYBOOKAPI__) {\n    loadHeader(doc.querySelector('header'));\n    loadFooter(doc.querySelector('footer'));\n  }\n\n  loadCSS(`${window.hlx.codeBasePath}/styles/lazy-styles.css`);\n  addFavIcon(`${window.hlx.codeBasePath}/styles/favicon.svg`);\n  sampleRUM('lazy');\n  sampleRUM.observe(main.querySelectorAll('div[data-block-name]'));\n  sampleRUM.observe(main.querySelectorAll('picture > img'));\n}\n\n/**\n * loads everything that happens a lot later, without impacting\n * the user experience.\n */\nfunction loadDelayed() {\n  // eslint-disable-next-line import/no-cycle\n  window.setTimeout(() => import('./delayed.js'), 3000);\n  if (!window.hlx.performance) window.setTimeout(() => import('./delayed.js'), 4000);\n  // load anything that can be postponed to the latest here\n}\n\nexport async function loadPage() {\n  await loadEager(document);\n  await loadLazy(document);\n  loadDelayed();\n}\n\nif (!window.__STORYBOOKAPI__) {\n  loadPage();\n}\n\nconst params = new URLSearchParams(window.location.search);\nif (params.get('performance')) {\n  window.hlx.performance = true;\n  import('./performance.js').then((mod) => {\n    if (mod.default) mod.default();\n  });\n}\n"],"names":["LCP_BLOCKS","build2ColHero","main","firstDiv","picture","section","heroBlock","buildBlock","buildImageHero","img","backgroundImage","cover","content","loadTemplate","template","cssLoaded","resolve","loadCSS","decorationComplete","mod","__variableDynamicImportRuntimeHelper","error","decorateTemplate","getMetadata","buildAutoBlocks","decorateButtons","element","a","up","twoup","decorateMain","decorateSections","decorateBlocks","loadTheme","themeLink","theme","isMobile","loadEager","doc","decorateTemplateAndTheme","waitForLCP","addFavIcon","href","link","existingLink","loadLazy","loadBlocks","decorateIcons","hash","loadHeader","loadFooter","sampleRUM","loadDelayed","__vitePreload","loadPage","params"],"mappings":"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"}